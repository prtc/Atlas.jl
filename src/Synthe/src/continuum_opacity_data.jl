"""
Continuum opacity lookup tables from Fortran HMINOP

Data extracted from atlas7v.for HMINOP subroutine (lines 5074-5178).

References:
- H⁻ bound-free: Mathisen (1984), after Wishart (1979) and Broad & Reinhardt (1976)
- H⁻ free-free: Bell and Berrington, J.Phys.B, vol. 20, 801-806, 1987

Author: Claude (Local), Paula Coelho
Date: 2025-11-14
"""

# H⁻ Bound-Free Lookup Table (Wishart 1979 via Mathisen 1984)
# 85 wavelength points (nm) and corresponding cross-sections (10⁻¹⁸ cm²)
const HMINUS_BF_WAVELENGTHS = [
    18.00,  19.60,  21.40,  23.60,  26.40,  29.80,  34.30,
    40.40,  49.10,  62.60, 111.30, 112.10, 112.67, 112.95, 113.05,
   113.10, 113.20, 113.23, 113.50, 114.40, 121.00, 139.00, 164.00,
   175.00, 200.00, 225.00, 250.00, 275.00, 300.00, 325.00, 350.00,
   375.00, 400.00, 425.00, 450.00, 475.00, 500.00, 525.00, 550.00,
   575.00, 600.00, 625.00, 650.00, 675.00, 700.00, 725.00, 750.00,
   775.00, 800.00, 825.00, 850.00, 875.00, 900.00, 925.00, 950.00,
   975.00,1000.00,1025.00,1050.00,1075.00,1100.00,1125.00,1150.00,
  1175.00,1200.00,1225.00,1250.00,1275.00,1300.00,1325.00,1350.00,
  1375.00,1400.00,1425.00,1450.00,1475.00,1500.00,1525.00,1550.00,
  1575.00,1600.00,1610.00,1620.00,1630.00,1643.91
]

const HMINUS_BF_CROSS_SECTIONS = [
   0.067,  0.088,  0.117,  0.155,  0.206,  0.283,  0.414,
   0.703,   1.24,   2.33,  11.60,  13.90,  24.30,  66.70,  95.00,
   56.60,  20.00,  14.60,   8.50,   7.10,   5.43,   5.91,   7.29,
   7.918,  9.453,  11.08,  12.75,  14.46,  16.19,  17.92,  19.65,
   21.35,  23.02,  24.65,  26.24,  27.77,  29.23,  30.62,  31.94,
   33.17,  34.32,  35.37,  36.32,  37.17,  37.91,  38.54,  39.07,
   39.48,  39.77,  39.95,  40.01,  39.95,  39.77,  39.48,  39.06,
   38.53,  37.89,  37.13,  36.25,  35.28,  34.19,  33.01,  31.72,
   30.34,  28.87,  27.33,  25.71,  24.02,  22.26,  20.46,  18.62,
   16.74,  14.85,  12.95,  11.07,  9.211,  7.407,  5.677,  4.052,
   2.575,  1.302, 0.8697, 0.4974, 0.1989,    0.0
]

# H⁻ Free-Free Lookup Tables (Bell & Berrington 1987)
# 22 wavelengths (inverse wavenumber: 91.134/k in nm) × 11 temperature (theta = 5040/T)

const HMINUS_FF_WAVELENGTHS_INVERSE_K = [0.50, 0.40, 0.35, 0.30, 0.25, 0.20, 0.18, 0.16, 0.14, 0.12, 0.10, 0.09, 0.08,
                                          0.07, 0.06, 0.05, 0.04, 0.03, 0.02, 0.01, 0.008, 0.006]

const HMINUS_FF_THETA_VALUES = [0.5, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.8, 3.6]

# 2D table: FF_TABLE[theta_index, wavelength_index]
# Values multiplied by corresponding factors as in Fortran DATA statements
const HMINUS_FF_TABLE = [
    # theta = 0.5
    [0.0178, 0.0228, 0.0277, 0.0364, 0.0520, 0.0791, 0.0965, 0.121, 0.154, 0.208, 0.293, 0.358, 0.448, 0.579, 0.781, 1.11, 1.73, 3.04, 6.79, 27.0, 42.3, 75.1] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 0.6
    [0.0222, 0.0280, 0.0342, 0.0447, 0.0633, 0.0959, 0.117, 0.146, 0.188, 0.250, 0.354, 0.432, 0.539, 0.699, 0.940, 1.34, 2.08, 3.65, 8.16, 32.4, 50.6, 90.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 0.8
    [0.0308, 0.0388, 0.0476, 0.0616, 0.0859, 0.129, 0.157, 0.195, 0.249, 0.332, 0.468, 0.572, 0.711, 0.924, 1.24, 1.77, 2.74, 4.80, 10.7, 42.6, 66.4, 118.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 1.0
    [0.0402, 0.0499, 0.0615, 0.0789, 0.108, 0.161, 0.195, 0.241, 0.309, 0.409, 0.576, 0.702, 0.871, 1.13, 1.52, 2.17, 3.37, 5.86, 13.1, 51.9, 80.8, 144.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 1.2
    [0.0498, 0.0614, 0.0760, 0.0966, 0.131, 0.194, 0.234, 0.288, 0.367, 0.484, 0.677, 0.825, 1.02, 1.33, 1.78, 2.53, 3.90, 6.86, 15.3, 60.7, 94.5, 168.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 1.4
    [0.0596, 0.0732, 0.0908, 0.114, 0.154, 0.227, 0.272, 0.334, 0.424, 0.557, 0.777, 0.943, 1.16, 1.51, 2.02, 2.87, 4.50, 7.79, 17.4, 68.9, 107.0, 191.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 1.6
    [0.0695, 0.0851, 0.105, 0.132, 0.178, 0.260, 0.311, 0.381, 0.482, 0.630, 0.874, 1.06, 1.29, 1.69, 2.26, 3.20, 5.01, 8.67, 19.4, 76.8, 120.0, 212.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 1.8
    [0.0795, 0.0972, 0.121, 0.150, 0.201, 0.293, 0.351, 0.428, 0.539, 0.702, 0.969, 1.17, 1.43, 1.86, 2.48, 3.51, 5.50, 9.50, 21.2, 84.2, 131.0, 234.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 2.0
    [0.0896, 0.110, 0.136, 0.169, 0.225, 0.327, 0.390, 0.475, 0.597, 0.774, 1.06, 1.28, 1.57, 2.02, 2.69, 3.80, 5.95, 10.3, 23.0, 91.4, 142.0, 253.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 2.8
    [0.131, 0.160, 0.199, 0.243, 0.321, 0.463, 0.549, 0.667, 0.830, 1.06, 1.45, 1.73, 2.09, 2.67, 3.52, 4.92, 7.59, 13.2, 29.5, 117.0, 183.0, 325.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890],
    # theta = 3.6
    [0.172, 0.211, 0.262, 0.318, 0.418, 0.602, 0.711, 0.861, 1.07, 1.36, 1.83, 2.17, 2.60, 3.31, 4.31, 5.97, 9.06, 15.6, 35.0, 140.0, 219.0, 388.0] .* [1823, 2278, 2604, 3038, 3645, 4557, 5063, 5696, 6510, 7595, 9113, 10126, 11392, 13019, 15189, 18227, 22784, 30378, 45567, 91134, 113918, 151890]
]


<html>
<head>
<title>KAPPA9</title>
</head>
<body BGCOLOR="lemonchiffon" TEXT="000000">

<font size=+2>

<pre>

<a href="http://wwwuser.oats.inaf.it/castelli/sources/kappa9/kappa9.pdf">about KAPPA9</a>

<a HREF="http://wwwuser.oats.inaf.it/castelli/sources/kappa9/kappa9.for">kappa9.for</a>--KAPPA9 for computing Rosseland opacities with NEWODF's

To compile it:

ifort -save -o kappa9.exe kappa9.for

After having computed k_Ross with KAPPA9 they have to be rearranged in ATLAS9 format. The code is:
  
<a HREF="http://wwwuser.oats.inaf.it/castelli/sources/kappa9/kapreadts.for">kapreadts.for</a>.

To compile it:

ifort -o kapreadts.exe kapreadts.for

The following example is the computation of k_Ross for metallicity [-4.0]
and microturbulent velocity 2.0 km/s:


<b>source kappa9m40k2.com</b>

where <a HREF="kappa9/kappa9m40k2.com">kappa9m40k2.com</a> is:

ln -s /home/castelli/diskal/atlas9/molecules.dat fort.2
ln -s /home/castelli/wwwuser/odfnew/m40big2.bdf fort.9
/home/castelli/diskal/kappa9/kappa9.exe<<EOF>kapm40k2.out
MOLECULES ON
READ MOLECULES
FREQUENCIES 337 1 337 BIG
ITERATIONS 1 PRINT 1 PUNCH 0 
TITLE ROSSELAND OPACITY FOR VTURB 2.0 KM/S
 OPACITY IFOP 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 0 0 0
 CONVECTION ON   1.25 TURBULENCE OFF  0.00  0.00  0.00  0.00
TEFF   5777.  GRAVITY 4.43770 LTE 
ABUNDANCE SCALE   0.0001 ABUNDANCE CHANGE 1 0.92156 2 0.078438
 ABUNDANCE CHANGE  3 -10.94  4 -10.64  5  -9.49  6  -3.52  7  -4.12  8  -3.21
 ABUNDANCE CHANGE  9  -7.48 10  -3.96 11  -5.71 12  -4.46 13  -5.57 14  -4.49
 ABUNDANCE CHANGE 15  -6.59 16  -4.71 17  -6.54 18  -5.64 19  -6.92 20  -5.68
 ABUNDANCE CHANGE 21  -8.87 22  -7.02 23  -8.04 24  -6.37 25  -6.65 26  -4.54
 ABUNDANCE CHANGE 27  -7.12 28  -5.79 29  -7.83 30  -7.44 31  -9.16 32  -8.63
 ABUNDANCE CHANGE 33  -9.67 34  -8.63 35  -9.41 36  -8.73 37  -9.44 38  -9.07
 ABUNDANCE CHANGE 39  -9.80 40  -9.44 41 -10.62 42 -10.12 43 -20.00 44 -10.20
 ABUNDANCE CHANGE 45 -10.92 46 -10.35 47 -11.10 48 -10.27 49 -10.38 50 -10.04
 ABUNDANCE CHANGE 51 -11.04 52  -9.80 53 -10.53 54  -9.87 55 -10.91 56  -9.91
 ABUNDANCE CHANGE 57 -10.87 58 -10.46 59 -11.33 60 -10.54 61 -20.00 62 -11.03
 ABUNDANCE CHANGE 63 -11.53 64 -10.92 65 -11.69 66 -10.90 67 -11.78 68 -11.11
 ABUNDANCE CHANGE 69 -12.04 70 -10.96 71 -11.98 72 -11.16 73 -12.17 74 -10.93
 ABUNDANCE CHANGE 75 -11.76 76 -10.59 77 -10.69 78 -10.24 79 -11.03 80 -10.91
 ABUNDANCE CHANGE 81 -11.14 82 -10.09 83 -11.33 84 -20.00 85 -20.00 86 -20.00
 ABUNDANCE CHANGE 87 -20.00 88 -20.00 89 -20.00 90 -11.95 91 -20.00 92 -12.54
 ABUNDANCE CHANGE 93 -20.00 94 -20.00 95 -20.00 96 -20.00 97 -20.00 98 -20.00
 ABUNDANCE CHANGE 99 -20.00
READ DECK6 72 RHOX,T,P,XNE,ABROSS,ACCRAD,VTURB
 5.12838287E-04   3709.1 1.405E+01 2.797E+09 2.600E-04 7.028E-02 1.500E+05 0.000E+00 0.000E+00
 6.71148215E-04   3732.6 1.839E+01 3.602E+09 3.019E-04 7.387E-02 1.500E+05 0.000E+00 0.000E+00
 8.53583147E-04   3754.9 2.339E+01 4.517E+09 3.483E-04 7.641E-02 1.500E+05 0.000E+00 0.000E+00
 1.06469772E-03   3778.6 2.917E+01 5.568E+09 4.009E-04 7.802E-02 1.500E+05 0.000E+00 0.000E+00
 1.30968473E-03   3803.4 3.588E+01 6.782E+09 4.596E-04 7.825E-02 1.500E+05 0.000E+00 0.000E+00
 1.59577136E-03   3828.9 4.372E+01 8.192E+09 5.233E-04 7.674E-02 1.500E+05 0.000E+00 0.000E+00
 1.93076383E-03   3853.7 5.290E+01 9.828E+09 5.962E-04 7.544E-02 1.500E+05 0.000E+00 0.000E+00
 2.32272392E-03   3877.9 6.364E+01 1.173E+10 6.797E-04 7.446E-02 1.500E+05 0.000E+00 0.000E+00
 2.78100631E-03   3901.7 7.619E+01 1.392E+10 7.755E-04 7.381E-02 1.500E+05 0.000E+00 0.000E+00
 3.31641180E-03   3924.9 9.086E+01 1.647E+10 8.855E-04 7.356E-02 1.500E+05 0.000E+00 0.000E+00
 3.94186646E-03   3947.9 1.080E+02 1.941E+10 1.010E-03 7.334E-02 1.500E+05 0.000E+00 0.000E+00
 4.67302051E-03   3970.8 1.280E+02 2.283E+10 1.152E-03 7.318E-02 1.500E+05 0.000E+00 0.000E+00
 5.52856151E-03   3993.7 1.515E+02 2.679E+10 1.312E-03 7.309E-02 1.500E+05 0.000E+00 0.000E+00
 6.53054813E-03   4016.5 1.789E+02 3.139E+10 1.494E-03 7.303E-02 1.500E+05 0.000E+00 0.000E+00
 7.70352445E-03   4039.3 2.111E+02 3.673E+10 1.703E-03 7.337E-02 1.500E+05 0.000E+00 0.000E+00
 9.07514808E-03   4062.0 2.486E+02 4.292E+10 1.943E-03 7.406E-02 1.500E+05 0.000E+00 0.000E+00
 1.06774833E-02   4085.1 2.925E+02 5.010E+10 2.219E-03 7.515E-02 1.500E+05 0.000E+00 0.000E+00
 1.25488575E-02   4108.9 3.438E+02 5.843E+10 2.533E-03 7.610E-02 1.500E+05 0.000E+00 0.000E+00
 1.47351857E-02   4133.5 4.037E+02 6.811E+10 2.891E-03 7.695E-02 1.500E+05 0.000E+00 0.000E+00
 1.72881496E-02   4158.4 4.736E+02 7.934E+10 3.303E-03 7.816E-02 1.500E+05 0.000E+00 0.000E+00
 2.02692929E-02   4184.1 5.553E+02 9.239E+10 3.770E-03 7.923E-02 1.500E+05 0.000E+00 0.000E+00
 2.37530891E-02   4210.6 6.508E+02 1.076E+11 4.302E-03 8.011E-02 1.500E+05 0.000E+00 0.000E+00
 2.78229282E-02   4237.5 7.623E+02 1.252E+11 4.913E-03 8.119E-02 1.500E+05 0.000E+00 0.000E+00
 3.25736063E-02   4264.9 8.924E+02 1.456E+11 5.614E-03 8.251E-02 1.500E+05 0.000E+00 0.000E+00
 3.81169004E-02   4292.8 1.044E+03 1.694E+11 6.416E-03 8.394E-02 1.500E+05 0.000E+00 0.000E+00
 4.45872937E-02   4321.3 1.222E+03 1.970E+11 7.328E-03 8.527E-02 1.500E+05 0.000E+00 0.000E+00
 5.21389910E-02   4349.7 1.428E+03 2.289E+11 8.376E-03 8.716E-02 1.500E+05 0.000E+00 0.000E+00
 6.09518129E-02   4378.4 1.670E+03 2.660E+11 9.568E-03 8.930E-02 1.500E+05 0.000E+00 0.000E+00
 7.12439100E-02   4407.3 1.952E+03 3.090E+11 1.092E-02 9.155E-02 1.500E+05 0.000E+00 0.000E+00
 8.32644240E-02   4436.2 2.281E+03 3.588E+11 1.247E-02 9.432E-02 1.500E+05 0.000E+00 0.000E+00
 9.72971259E-02   4465.0 2.666E+03 4.165E+11 1.425E-02 9.770E-02 1.500E+05 0.000E+00 0.000E+00
 1.13672868E-01   4493.8 3.114E+03 4.834E+11 1.629E-02 1.018E-01 1.500E+05 0.000E+00 0.000E+00
 1.32786810E-01   4523.1 3.638E+03 5.610E+11 1.860E-02 1.062E-01 1.500E+05 0.000E+00 0.000E+00
 1.55098562E-01   4552.3 4.249E+03 6.509E+11 2.126E-02 1.115E-01 1.500E+05 0.000E+00 0.000E+00
 1.81139153E-01   4581.5 4.963E+03 7.549E+11 2.428E-02 1.176E-01 1.500E+05 0.000E+00 0.000E+00
 2.11544893E-01   4611.0 5.796E+03 8.755E+11 2.773E-02 1.244E-01 1.500E+05 0.000E+00 0.000E+00
 2.47052781E-01   4640.6 6.768E+03 1.015E+12 3.167E-02 1.323E-01 1.500E+05 0.000E+00 0.000E+00
 2.88507698E-01   4670.5 7.904E+03 1.177E+12 3.617E-02 1.414E-01 1.500E+05 0.000E+00 0.000E+00
 3.36895159E-01   4701.0 9.230E+03 1.365E+12 4.133E-02 1.520E-01 1.500E+05 0.000E+00 0.000E+00
 3.93366856E-01   4732.7 1.078E+04 1.584E+12 4.723E-02 1.642E-01 1.500E+05 0.000E+00 0.000E+00
 4.59259744E-01   4765.8 1.258E+04 1.839E+12 5.398E-02 1.782E-01 1.500E+05 0.000E+00 0.000E+00
 5.36129287E-01   4800.8 1.469E+04 2.136E+12 6.171E-02 1.943E-01 1.500E+05 0.000E+00 0.000E+00
 6.25814366E-01   4838.3 1.715E+04 2.484E+12 7.053E-02 2.122E-01 1.500E+05 0.000E+00 0.000E+00
 7.30438050E-01   4879.0 2.001E+04 2.893E+12 8.064E-02 2.328E-01 1.500E+05 0.000E+00 0.000E+00
 8.52425560E-01   4924.1 2.335E+04 3.376E+12 9.225E-02 2.564E-01 1.500E+05 0.000E+00 0.000E+00
 9.94567773E-01   4974.7 2.725E+04 3.951E+12 1.056E-01 2.834E-01 1.500E+05 0.000E+00 0.000E+00
 1.16008551E+00   5032.4 3.178E+04 4.641E+12 1.210E-01 3.143E-01 1.500E+05 0.000E+00 0.000E+00
 1.35274770E+00   5099.6 3.706E+04 5.480E+12 1.387E-01 3.498E-01 1.500E+05 0.000E+00 0.000E+00
 1.57666446E+00   5177.6 4.320E+04 6.515E+12 1.593E-01 3.908E-01 1.500E+05 0.000E+00 0.000E+00
 1.83606723E+00   5269.2 5.030E+04 7.829E+12 1.838E-01 4.392E-01 1.500E+05 0.000E+00 0.000E+00
 2.13471080E+00   5375.8 5.848E+04 9.551E+12 2.139E-01 4.990E-01 1.500E+05 1.240E-09 0.000E+00
 2.47332025E+00   5504.6 6.776E+04 1.198E+13 2.545E-01 5.827E-01 1.500E+05 3.933E-08 0.000E+00
 2.84881471E+00   5650.2 7.805E+04 1.554E+13 3.098E-01 7.002E-01 1.500E+05 3.308E-06 0.000E+00
 3.24852750E+00   5843.7 8.900E+04 2.190E+13 4.021E-01 9.037E-01 1.500E+05 5.162E-04 0.000E+00
 3.63863046E+00   6100.3 9.968E+04 3.491E+13 5.768E-01 1.244E+00 1.500E+05 1.547E-02 1.626E+03
 3.99186702E+00   6359.7 1.094E+05 5.674E+13 8.514E-01 1.662E+00 1.500E+05 8.664E-02 2.998E+03
 4.32516876E+00   6560.2 1.185E+05 8.310E+13 1.163E+00 2.017E+00 1.500E+05 1.667E-01 5.056E+03
 4.64876290E+00   6778.0 1.274E+05 1.237E+14 1.621E+00 2.550E+00 1.500E+05 2.433E-01 2.240E+04
 4.95288884E+00   7030.4 1.357E+05 1.908E+14 2.340E+00 3.362E+00 1.500E+05 3.121E-01 5.586E+04
 5.23070832E+00   7308.0 1.433E+05 2.979E+14 3.453E+00 4.545E+00 1.500E+05 3.719E-01 8.952E+04
 5.47879852E+00   7619.0 1.501E+05 4.727E+14 5.229E+00 6.441E+00 1.500E+05 4.181E-01 1.403E+05
 5.68988391E+00   7981.7 1.559E+05 7.723E+14 8.308E+00 8.682E+00 1.500E+05 5.058E-01 2.085E+05
 5.87591173E+00   8275.3 1.610E+05 1.118E+15 1.195E+01 8.487E+00 1.500E+05 6.602E-01 2.211E+05
 6.05637485E+00   8508.5 1.659E+05 1.478E+15 1.586E+01 7.902E+00 1.500E+05 7.612E-01 2.254E+05
 6.23957016E+00   8729.1 1.709E+05 1.901E+15 2.059E+01 7.414E+00 1.500E+05 8.290E-01 2.261E+05
 6.43191469E+00   8918.9 1.762E+05 2.343E+15 2.570E+01 6.910E+00 1.500E+05 8.718E-01 2.240E+05
 6.63749632E+00   9111.8 1.818E+05 2.874E+15 3.200E+01 6.559E+00 1.500E+05 9.031E-01 2.216E+05
 6.86094505E+00   9283.7 1.880E+05 3.433E+15 3.879E+01 6.111E+00 1.500E+05 9.250E-01 2.180E+05
 7.10613604E+00   9466.6 1.947E+05 4.118E+15 4.724E+01 5.827E+00 1.500E+05 9.417E-01 2.148E+05
 7.37808777E+00   9631.9 2.021E+05 4.840E+15 5.619E+01 5.417E+00 1.500E+05 9.541E-01 2.106E+05
 7.68129689E+00   9813.4 2.104E+05 5.740E+15 6.752E+01 5.181E+00 1.500E+05 9.638E-01 2.072E+05
 8.02184660E+00   9977.4 2.197E+05 6.688E+15 7.936E+01 5.099E+00 1.500E+05 9.695E-01 2.027E+05
PRADK 1.4828E+00
VTURB 2.0E5
BEGIN                    ITERATION  15 COMPLETED
END
EOF
mv fort.7 kapm40k2.dat
rm fort.*



For OTHER METALLICITIES::

1) change the file: m40big2.bdf
2) change the abundances in the model starting from
   ABUNDANCE SCALE
   to
   ABUNDANCE CHANGE 99

The abundances in the model must be the same used for computing ODFs.   

For OTHER MICROTURBULENT VELOCITIES the card to be changed is:
VTURB 2.0E5 
which is located after the model.
The ODF file should be that computed for the same VTURB !

Do not change the model.



To rearrange k_Ross:


<a HREF="http://wwwuser.oats.inaf.it/castelli/sources/kappa9/kapreadts.com">kapreadts.com</a>


ln -s kapm40k0.dat fort.11
ln -s kapm40k1.dat fort.12
ln -s kapm40k2.dat fort.13
ln -s kapm40k4.dat fort.14
ln -s kapm40k8.dat fort.15
/home/castelli/diskal/kappa9/kapreadts.exe
mv fort.2 kapm40.ros
rm fort.*



</pre>
</body>
</html>

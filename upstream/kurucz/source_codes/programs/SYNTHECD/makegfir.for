      PROGRAM MAKEGFIRONQ
C     CONVERTS GFIRON TAPE FROM ASCII TO BINARY
      DIMENSION LABEL(2),LABELP(2)
      REAL*8 WL,E,EP,LABEL,LABELP
      DIMENSION POWERS(77)
      DATA POWERS/
     1 1.E-38,1.E-37,1.E-36,1.E-35,1.E-34,1.E-33,1.E-32,1.E-31,
     2 1.E-30,1.E-29,1.E-28,1.E-27,1.E-26,1.E-25,1.E-24,1.E-23,
     3 1.E-22,1.E-21,1.E-20,1.E-19,1.E-18,1.E-17,1.E-16,1.E-15,
     4 1.E-14,1.E-13,1.E-12,1.E-11,1.E-10,1.E-09,1.E-08,1.E-07,
     5 1.E-06,1.E-05,1.E-04,1.E-03,1.E-02,1.E-01,1.E-00,1.E+01,
     6 1.E+02,1.E+03,1.E+04,1.E+05,1.E+06,1.E+07,1.E+08,1.E+09,
     7 1.E+10,1.E+11,1.E+12,1.E+13,1.E+14,1.E+15,1.E+16,1.E+17,
     8 1.E+18,1.E+19,1.E+20,1.E+21,1.E+22,1.E+23,1.E+24,1.E+25,
     9 1.E+26,1.E+27,1.E+28,1.E+29,1.E+30,1.E+31,1.E+32,1.E+33,
     A 1.E+34,1.E+35,1.E+36,1.E+37,1.E+38/
C     CALL FILEREP
      OPEN(UNIT=7,STATUS='OLD',READONLY)
      OPEN(UNIT=12,BLOCKSIZE=8000,RECORDSIZE=20,RECORDTYPE='FIXED',
     1STATUS='NEW',FORM='UNFORMATTED')
      ILINE=0
C      DO 9 I=1,1000
      DO 9 I=1,1000000
      READ(7,2,END=90)WL,GFLOG,CODE,E,XJ,LABEL,EP,XJP,LABELP,
     1 I1,I2,I3,I4,I5,I6,I7,I1P,I2P,I3P,I4P,I5P,I6P,I7P
    2 FORMAT(F12.4,F7.3,F6.2,F12.3,F4.1,1X,A8,A2,F13.3,F4.1,1X,A8,A2,
     1 I5,I4,I3,I4,I3,I4,I3,I5,I4,I3,I4,I3,I4,I3)
      ILINE=ILINE+1
C      PRINT 2,WL,GFLOG,CODE,E,XJ,LABEL,EP,XJP,LABELP,
C     1 I1,I2,I3,I4,I5,I6,I7,I1P,I2P,I3P,I4P,I5P,I6P,I7P
      GLANDE=I1*.001
      ASUM=I2*POWERS(I3+36)
      C4=I4*POWERS(I5+36)
      C6=I6*POWERS(I7+36)
      GLANDEP=I1P*.001
      ASUMP=I2P*POWERS(I3P+36)
      C4P=I4P*POWERS(I5P+36)
      C6P=0.
      IF(I7P.GT.-36)C6P=I6P*POWERS(I7P+36)
C
C     THE DAMPING CONSTANTS ARE COMPUTED FROM SUMS OVER ALL POSSIBLE 
C     TRANSITIONS TO A GIVEN LEVEL (KURUCZ, SAO SPECIAL REPORT 390,1981).
C     THESE SUMS ARE NOT COMPLETE EXCEPT FOR ASUMS FOR LEVELS BELOW 
C     THE LOWEST LEVEL LEFT OUT OF THE CALCULATIONS.  CONSULT THE OUTPUT
C     LISTINGS FOR THE LEAST SQUARES FITS BXXXXE.OUT,BXXXXO.OUT,
C     CXXXXE.OUT,CXXXXO.OUT TO DETERMINE WHICH CONFIGURATIONS WERE INCLUDED.
C     THE SUMS SHOULD BE COMPLETE OR NEARLY SO FOR MOST STRONG LINES. 
C
C     GAMMAW IS THE DAMPING CONSTANT PER HYDROGEN ATOM FOR VAN DER WAALS
C            BROADENING BY HYDROGEN AT T=10000K.
C            =84762*C6**.4 FROM ALLER
C            FOR HELIUM MULTIPLY BY .42
C            FOR H2 MULTIPLY BY .85
C     GAMMAS IS THE STARK DAMPING CONSTANT PER ELECTRON ASSUMED TO BE
C            TEMPERATURE INDEPENDENT
C            =15385*C4**(2/3) AT 10000K FROM ALLER
C     
      GRLOG=ALOG10(ASUM+ASUMP)
C     THESE DAMPING CONSTANTS ARE TOO SMALL
C      GSLOG=ALOG10(15835.*(AMAX1(ABS(C4P-C4),
C     1AMIN1(ABS(C4),ABS(C4P))))**.6666667)
C      GWLOG=ALOG10(84762.*(AMAX1(ABS(C6P-C6),
C     1AMIN1(ABS(C6),ABS(C6P))))**.4)
C
C     TRY NOT DIFFERENCING 
      GSLOG=ALOG10(15835.*AMAX1(ABS(C4),ABS(C4P))**.6666667)
      GWLOG=ALOG10(84762.*AMAX1(ABS(C6),ABS(C6P))**.4)
      JJJJ=XJ*2000.+XJP*2.
      WRITE(12)WL,GFLOG,E,EP,CODE,LABEL,LABELP,JJJJ,GRLOG,GSLOG,GWLOG
      IF(MOD(ILINE,1000).EQ.0)
     1PRINT 7,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,GRLOG,GSLOG,
     2GWLOG
      IF(ILINE.LE.100)
     1PRINT 7,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,GRLOG,GSLOG,
     2GWLOG
c      IF(GRLOG.GE.10.)
c     1PRINT 7,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,GRLOG,GSLOG,
c     2GWLOG
    7 FORMAT(I10,F10.4,F7.3,F4.1,F13.3,F4.1,F13.3,F9.2,1X,A8,A2,
     1 1X,A8,A2,3F8.3)
    9 CONTINUE
   90 PRINT 7,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,GRLOG,GSLOG,
     1GWLOG
      CALL EXIT
      END

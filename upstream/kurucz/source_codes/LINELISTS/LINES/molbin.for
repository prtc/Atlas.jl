      PROGRAM MOLBIN
      REAL*8 WL,E,EP,LABEL,LABELP
      REAL*4 GFLOG,XJ,XJP,CODE
      OPEN(UNIT=2,STATUS='NEW',FORM='UNFORMATTED',
     1RECORDTYPE='FIXED',BLOCKSIZE=12000,RECL=15)
      DO 8 ILINE=1,9999999
      READ(1,2,END=9)WL,GFLOG,XJ,E,XJP,EP,ICODE,LABEL,LABELP,ISO
    2 FORMAT(F10.4,F7.3,F5.1,F10.3,F5.1,F11.3,I4,A8,A8,I2)
      IF(E.LT.0.)WL=-ABS(WL)
      IF(EP.LT.0.)WL=-ABS(WL)
      CODE=ICODE
      WRITE(2)WL,E,EP,LABEL,LABELP,GFLOG,XJ,XJP,CODE,ISO
      IF(MOD(ILINE,1000).NE.0)GO TO 8
      IF(ABS(WL).LT.9999.999)THEN
      PRINT 3,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,ISO
    3 FORMAT(I10,1X,F10.4,F7.3,F5.1,F12.3,F5.1,F12.3,F9.2,A8,2X,A8,I2)
      ELSE
      PRINT 4,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,ISO
    4 FORMAT(I10,1X,F10.3,F7.3,F5.1,F12.3,F5.1,F12.3,F9.2,A8,2X,A8,I2)
      ENDIF
    8 CONTINUE
    9 N=ILINE-1
      IF(ABS(WL).LT.9999.999)THEN
      PRINT 3,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,ISO
      ELSE
      PRINT 4,ILINE,WL,GFLOG,XJ,E,XJP,EP,CODE,LABEL,LABELP,ISO
      ENDIF
      CALL EXIT
      END

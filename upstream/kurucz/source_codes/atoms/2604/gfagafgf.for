      PROGRAM GFAGAFGF
C     Rewrites GFEMQ*.POS line list into *.AGAFGF format.
C     TAPE1   GFEMQ*.POS 
C     TAPE15  GFEMQ*.AGAFGF    WL,WN,gf,f,femiss,A,gA but no broadening 
      IMPLICIT REAL*8 (A-H,O-Z)
      CHARACTER*10 ELAB,ELABP
      CHARACTER*4 REF
      OPEN(UNIT=1,STATUS='OLD',RECL=160,CARRIAGECONTROL='LIST')
      OPEN(UNIT=15,STATUS='NEW',CARRIAGECONTROL='LIST')
      WRITE(15,1515)
 1515 FORMAT('     wl(nm)   ','  wn(cm-1)',' log gf','  log f',' log fe',
     1       '  log A',' log gA')
      DO 99 ILINE=1,9999999
      READ(1,140,END=100)WL,GFLOG,CODE,E,XJ,ELAB,EP,XJP,ELABP,GAMMAR,
     1 GAMMAS,GAMMAW,REF
  140 FORMAT(F11.4,F7.3,F6.2,F12.3,F5.1,1X,A10,F12.3,F5.1,1X,A10,
     1 F6.2,F6.2,F6.2,A4)
      WAVENO=ABS(ABS(E)-ABS(EP))
      WLVAC=1.D7/WAVENO
      WAVENO=MIN(WAVENO,9999999.9999D0)
      GLO=XJ+XJ+1.
      GUP=XJP+XJP+1.
      IF(ABS(E).GT.ABS(EP))THEN
      GLO=XJP+XJP+1.
      GUP=XJ+XJ+1.
      ENDIF
      GF=10**GFLOG
      A=GF*66702.E9/WLVAC**2/GUP
      FLOG=GFLOG-LOG10(GLO)
      FEMISSLOG=GFLOG-LOG10(GUP)
      GALOG=GFLOG+LOG10(66702.E9/WLVAC**2)
      ALOG=GALOG-LOG10(GUP)
      WRITE(15,144)WL,WAVENO,GFLOG,FLOG,FEMISSLOG,ALOG,GALOG,CODE,
     1 E,XJ,ELAB,EP,XJP,ELABP,REF
  144 FORMAT(F12.4,F12.3,5F7.3,F6.2,F12.3,F5.1,1X,A10,F12.3,F5.1,1X,A10,
     1 A4)
   99 CONTINUE
  100 CALL EXIT
      END
